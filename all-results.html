<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Káº¿t quáº£ hÃ¡i lá»™c</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
</head>
<body>

    <nav>
        <ul>
            <li><a href="index.html">ğŸ® HÃ¡i lá»™c</a></li>
            <li><a href="all-results.html">ğŸ“œ Lá»™c Ä‘Ã£ hÃ¡i</a></li>
        </ul>
    </nav>

    <div class="container">
        <h1>ğŸ“œ Káº¿t quáº£ hÃ¡i lá»™c ğŸ“œ</h1>
        <table id="resultTable">
            <thead>
                <tr>
                    <th>#</th>
                    <th>NgÆ°á»i chÆ¡i</th>
                    <th>CÃ¢u lá»™c</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button onclick="clearAllResults()">ğŸ—‘ XÃ³a toÃ n bá»™ káº¿t quáº£</button>
    </div>
    
    <script src="flowers.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, onChildAdded, remove } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD-xb0w9kSxkTXPLQz5HsyEgBzBhEx9c9Q",
            authDomain: "game-hai-loc.firebaseapp.com",
            databaseURL: "https://game-hai-loc-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "game-hai-loc",
            storageBucket: "game-hai-loc.firebasestorage.app",
            messagingSenderId: "986400836091",
            appId: "1:986400836091:web:92827f200f821ab507e35e"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const resultsRef = ref(database, "gameResults");

        function loadAllResults() {
            const tbody = document.querySelector("#resultTable tbody");
            tbody.innerHTML = "";

            onChildAdded(resultsRef, (snapshot) => {
                const data = snapshot.val();
                const row = `<tr><td>${tbody.children.length + 1}</td><td>${data.name}</td><td>${data.quote}</td></tr>`;
                tbody.innerHTML += row;
            });
        }

        function clearAllResults() {
            if (confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a toÃ n bá»™ káº¿t quáº£ khÃ´ng?")) {
                remove(resultsRef).then(() => {
                    document.querySelector("#resultTable tbody").innerHTML = "";
                    alert("ÄÃ£ xÃ³a toÃ n bá»™ káº¿t quáº£!");
                }).catch(error => {
                    console.error("Lá»—i khi xÃ³a dá»¯ liá»‡u: ", error);
                });
            }
        }

        // GÃ¡n vÃ o `window` Ä‘á»ƒ cÃ³ thá»ƒ gá»i tá»« HTML
        window.loadAllResults = loadAllResults;

        // Gá»i loadAllResults khi trang táº£i
        window.onload = loadAllResults;
    </script>

</body>
</html>